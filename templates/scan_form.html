<!-- scan_form.html -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <div>
    <h1>QR Code Scan Form.</h1>

    <div style="width: 300px" id="reader"></div>
    <!-- <div id="reader" width="50px" height="50px"></div> -->
    <!-- <div class="input-group">
      <input type="text" name="kode_barang" id="kode_barang" class="form-control"
        placeholder="Cari Kode Barang/ Barcode">
      <div class="input-group-append">
        <button class="btn btn-primary" id="btnsearch" type="button">
          <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20" height="20" viewBox="0 0 50 50"
            style=" fill:#000000;">
            <path
              d="M 21 3 C 11.621094 3 4 10.621094 4 20 C 4 29.378906 11.621094 37 21 37 C 24.710938 37 28.140625 35.804688 30.9375 33.78125 L 44.09375 46.90625 L 46.90625 44.09375 L 33.90625 31.0625 C 36.460938 28.085938 38 24.222656 38 20 C 38 10.621094 30.378906 3 21 3 Z M 21 5 C 29.296875 5 36 11.703125 36 20 C 36 28.296875 29.296875 35 21 35 C 12.703125 35 6 28.296875 6 20 C 6 11.703125 12.703125 5 21 5 Z">
            </path>
          </svg>
        </button>
      </div>
    </div> -->

    <form id="form_isbn" method="post">
      {% csrf_token %}
      {{ form.as_p }}
      <input type="submit" value="Submit">
    </form>

    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <script >
      //import {Html5Qrcode} from "html5-qrcode";
      function onScanSuccess(decodedText, decodedResult) {
        // handle the scanned code as you like, for example:
        console.log(`Code matched = ${decodedText}`, decodedResult);
        html5QrcodeScanner.clear();
        document.getElementById('id_isbn').value = decodedText;
        document.getElementById('form_isbn').submit();
      }

      function onScanFailure(error) {
        // handle scan failure, usually better to ignore and keep scanning.
        // for example:
        console.warn(`Code scan error = ${error}`);
      }

      let html5QrcodeScanner = new Html5QrcodeScanner
      (
        "reader",
        { fps: 10, qrbox: {width: 250, height: 250} },
        /* verbose= */ false);
      html5QrcodeScanner.render(onScanSuccess, onScanFailure);

    </script>
  </div>

</body>

</html>